# 命令行控制
默认的可执行二进制文件路径为：`/usr/local/nginx/sbin/nginx`

##1、默认启动方式

```shell
/usr/local/nginx/sbin/nginx
```
这种方式启动会去读配置文件，即在执行`configure`时的`conf-path=PATH`指定的`nginx.conf`文件，该文件路径默认为：`/usr/local/nginx/conf/nginx.conf`。

##2、指定配置文件启动

```shell
/usr/local/nginx/sbin/nginx -c /tmp/nginx.conf
```
通过`-c`选项来指定配置文件。

##3、指定nginx的安装目录启动

```shell
/usr/local/nginx/sbin/nginx -p /usr/local/nginx
```
通过`-p`选项来指定nginx的安装目录

##4、指定全局配置项启动

```shell
/usr/local/nginx/sbin/nginx -g "pid /var/nginx/test.pid;"
```
以上命令表示把pid文件写到`/var/nginx/test.pid`文件中，相当于在`nginx.conf`中配置pid项。此种方式下启动时添加的全局配置项不能在`nginx.conf`文件中配置，否则会因为冲突而无法启动。此外，以`-g`参数启动的进程，在执行其他命令时要带上同样的参数。例如，要停止时：

```shell
/usr/local/nginx/sbin/nginx -g "pid /var/nginx/test.pid;" -s stop
```
如果没有带上该选项，那么将找不到pid文件（因为在`nginx.conf`中没有配置）。

##5、测试配置信息是否错误
在不启动Nginx的情况下，使用`-t`参数仅测试配置文件是否有错误。

```shell
/usr/local/nginx/sbin/nginx -t
```

##6、在测试阶段不输出信息
使用`-q`参数将不会把error级别以下的信息输出到屏幕。

```shell
/usr/local/nginx/sbin/nginx -q
```

##7、显示版本信息

```shell
/usr/local/nginx/sbin/nginx -v
```

##8、显示编译阶段的参数
`-V`除了可以显示Nginx的版本，还可以显示配置编译阶段的信息。如GCC编译器版本、操作系统及执行`configure`时的参数等。

```shell
/usr/local/nginx/sbin/nginx -V
```

##9、快速地停止服务

```shell
/usr/local/nginx/sbin/nginx -s stop
```
`-s`即发送信号。以上命令执行时，Nginx将通过`nginx.pid`文件获取到master进程的进程ID，再向master进程发送`TERM`信号来快速关闭Nginx服务。
执行以上命令的过程类似于先通过`ps`查看Nginx的master进程ID，接着执行`kill`命令关闭进程：

```shell
root@vagrant-nginx:# ps -ef | grep nginx
root     11733  1618  0 23:33 pts/0    00:00:00 grep --color=auto nginx
root     28719     1  0 01:03 ?        00:00:00 nginx: master process /usr/local/nginx/sbin/nginx
nobody   28720 28719  0 01:03 ?        00:00:00 nginx: worker process

root@vagrant-nginx:# kill -s SIGTRM 28719
```

##10、”优雅“地停止服务

```shell
/usr/local/nginx/sbin/nginx -s quit
```
该命令会在Nginx服务正常处理完当前所有请求再停止服务。同样地，相当于获取了master的ID之后，发送`QUIT`信号给该进程。

```shell
kill -s SIGQUIT pid
```

##11、重新读取配置

```shell
/usr/local/nginx/sbin/nginx -s reload
```
相当于发送了HUP信号：

```shell
kill -s SIGHUP pid
```

##12、平滑升级
平滑升价的过程包括三个步骤：
>* 通知正在运行的旧版Nginx服务准备升级；
>* 启动新版本的Nginx；
>* 停止旧版本的的master进程

###通知正在运行的旧版Nginx服务准备升级
通过向master进程发送`USR2`信号，Nginx服务会将pid文件重命名，如将`/usr/local/nginx/logs/nginx.pid`重命名为`/usr/local/nginx/logs/nginx.pid.oldbin`。

```shell
kill -s SIGUSR2 pid
```

###启动新版本的Nginx
可通过任意一种方式启动新的Nginx。

###停止旧版本的的master进程
以优雅的方式将旧版服务停止。

```shell
kill -s SIGQUIT pid
```

